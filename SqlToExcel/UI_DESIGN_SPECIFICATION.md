# SQL to Excel UI 设计规范

## 1. 设计原则

### 1.1 一致性
- 所有界面元素保持视觉和交互的一致性
- 使用统一的颜色、字体、间距和布局规则

### 1.2 简洁性
- 界面清晰简洁，避免视觉混乱
- 功能分组明确，层次分明

### 1.3 易用性
- 操作直观，减少用户学习成本
- 提供清晰的视觉反馈

## 2. 颜色规范

### 2.1 主题色
```
主色调 (Primary): #2196F3 (蓝色)
次要色 (Secondary): #4CAF50 (绿色)
强调色 (Accent): #FF9800 (橙色)
危险色 (Danger): #F44336 (红色)
警告色 (Warning): #FFC107 (黄色)
信息色 (Info): #00BCD4 (青色)
```

### 2.2 中性色
```
背景色 (Background): #FFFFFF (浅色主题) / #1E1E1E (深色主题)
卡片背景: #F5F5F5 (浅色主题) / #2D2D2D (深色主题)
边框色: #E0E0E0 (浅色主题) / #3C3C3C (深色主题)
文本主色: #212121 (浅色主题) / #E0E0E0 (深色主题)
文本次要色: #757575 (浅色主题) / #9E9E9E (深色主题)
```

## 3. 字体规范

### 3.1 字体家族
- 中文: Microsoft YaHei UI
- 英文/数字: Segoe UI
- 代码/SQL: Consolas

### 3.2 字体大小
```
标题1: 24px (主窗口标题)
标题2: 18px (对话框标题)
标题3: 16px (卡片标题)
正文: 14px (默认文本)
小字: 12px (辅助说明)
```

### 3.3 字重
- 标题: SemiBold (600)
- 正文: Regular (400)
- 强调: Bold (700)

## 4. 间距规范

### 4.1 外边距 (Margin)
```
特小: 5px
小: 10px
中: 15px
大: 20px
特大: 30px
```

### 4.2 内边距 (Padding)
```
按钮: 10px 20px
输入框: 8px 12px
卡片: 15px
对话框: 20px
```

### 4.3 组件间距
- 同组元素: 5px
- 不同组元素: 15px
- 区块间距: 20px

## 5. 组件规范

### 5.1 窗口
- 主窗口: 使用 `hc:BlurWindow` 实现毛玻璃效果
- 对话框: 统一使用 `hc:BlurWindow`
- 默认大小:
  - 主窗口: 1200x900
  - 大型对话框: 800x600
  - 中型对话框: 600x450
  - 小型对话框: 400x300

### 5.2 按钮
```xml
<!-- 主要操作 -->
<Button Style="{StaticResource ButtonPrimary}" />

<!-- 次要操作 -->
<Button Style="{StaticResource ButtonDefault}" />

<!-- 成功操作 -->
<Button Style="{StaticResource ButtonSuccess}" />

<!-- 危险操作 -->
<Button Style="{StaticResource ButtonDanger}" />

<!-- 信息操作 -->
<Button Style="{StaticResource ButtonInfo}" />

<!-- 警告操作 -->
<Button Style="{StaticResource ButtonWarning}" />
```

按钮尺寸:
- 大按钮: Height="40" MinWidth="120"
- 中按钮: Height="32" MinWidth="100"
- 小按钮: Height="28" MinWidth="80"

### 5.3 输入框
- 统一使用 `hc:TextBox`
- 包含占位符文本
- 验证状态显示

### 5.4 卡片
- 使用 `hc:Card` 组件
- 统一圆角: CornerRadius="4"
- 阴影效果: Effect="{StaticResource EffectShadow2}"

### 5.5 数据表格
- 使用自定义 DataGrid 样式
- 表头背景: Primary Color
- 交替行背景
- 悬停效果
- 选中高亮

### 5.6 图标
- 使用 Material Design Icons
- 图标大小: 16x16 (小), 20x20 (中), 24x24 (大)
- 与文本对齐: VerticalAlignment="Center"

## 6. 布局规范

### 6.1 网格布局
- 优先使用 Grid 布局
- 合理使用 Auto, *, 比例分配
- 避免硬编码宽高

### 6.2 响应式设计
- 最小窗口尺寸: 800x600
- 使用 MinWidth/MinHeight
- 考虑不同分辨率适配

### 6.3 对齐
- 标签右对齐，输入框左对齐
- 按钮组右对齐
- 使用统一的对齐基线

## 7. 交互规范

### 7.1 反馈
- 加载状态: 使用进度条或加载动画
- 操作成功: 显示成功提示
- 操作失败: 显示错误信息
- 禁用状态: 降低透明度

### 7.2 快捷键
- 确认: Enter
- 取消: Escape
- 保存: Ctrl+S
- 导出: Ctrl+E

### 7.3 焦点管理
- Tab 键顺序合理
- 默认焦点在主要操作上
- 输入框自动获取焦点

## 8. 动画规范

### 8.1 过渡动画
- 持续时间: 200-300ms
- 缓动函数: Ease-in-out
- 避免过度动画

### 8.2 加载动画
- 使用 HandyControl 提供的加载组件
- 保持动画流畅
- 提供取消选项

## 9. 主题支持

### 9.1 浅色主题
- 默认主题
- 高对比度
- 适合日间使用

### 9.2 深色主题
- 护眼模式
- 降低亮度
- 适合夜间使用

### 9.3 主题切换
- 实时切换
- 保存用户偏好
- 平滑过渡

## 10. 实施步骤

1. **创建资源字典**
   - Styles.xaml: 通用样式
   - Colors.xaml: 颜色定义
   - Icons.xaml: 图标资源
   - Templates.xaml: 控件模板

2. **组件标准化**
   - 创建自定义控件
   - 封装常用组合
   - 提供使用示例

3. **逐步迁移**
   - 优先级: 主窗口 > 常用对话框 > 其他界面
   - 保持功能稳定
   - 充分测试

4. **文档维护**
   - 更新设计规范
   - 记录变更历史
   - 提供最佳实践

## 11. 命名规范

### 11.1 资源键命名
```
样式: [控件类型]Style[描述]
颜色: [用途]Color[描述]
画刷: [用途]Brush[描述]
模板: [控件类型]Template[描述]
```

### 11.2 控件命名
```
按钮: btn[功能]
文本框: txt[用途]
标签: lbl[描述]
列表: lst[内容]
网格: grd[数据]
```

## 12. 可访问性

### 12.1 对比度
- 文本与背景对比度 >= 4.5:1
- 大文本对比度 >= 3:1

### 12.2 键盘导航
- 所有功能可通过键盘访问
- 提供快捷键提示
- 焦点指示清晰

### 12.3 屏幕阅读器
- 提供有意义的控件名称
- 使用 AutomationProperties
- 描述性工具提示